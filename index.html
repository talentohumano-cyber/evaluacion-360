<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evaluaci√≥n 360</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Roboto', sans-serif; background-color: #f0f2f5; margin: 0; padding: 20px; display: flex; justify-content: center; }
        
        /* Estilos de las Tarjetas */
        .contenedor { background: white; padding: 2rem; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); width: 100%; max-width: 500px; text-align: center; }
        
        /* Ocultar cosas por defecto */
        .oculto { display: none; }
        
        h1 { color: #1a73e8; margin-top: 0; }
        h2 { color: #202124; font-size: 1.2rem; margin-bottom: 20px; }
        
        input, textarea { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; font-family: inherit; }
        
        /* Input del Login */
        #idEmpleado { text-align: center; font-size: 1.2rem; letter-spacing: 2px; }

        button { width: 100%; padding: 12px; background-color: #1a73e8; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: bold; margin-top: 10px; }
        button:hover { background-color: #1557b0; }
        
        /* Estilos de las preguntas */
        .bloque-pregunta { text-align: left; margin-bottom: 20px; border-bottom: 1px solid #eee; padding-bottom: 20px; }
        .texto-pregunta { font-weight: 500; color: #444; margin-bottom: 8px; display: block; }
        textarea { resize: vertical; min-height: 80px; }

        .error { color: #d93025; font-weight: bold; margin-top: 10px; }
    </style>
</head>
<body>

    <div id="pantalla-login" class="contenedor">
        <h1>Bienvenido</h1>
        <p>Sistema de Evaluaci√≥n 360¬∞</p>
        <input type="number" id="idEmpleado" placeholder="ID de Empleado">
        <button id="btnEntrar" onclick="iniciarSesion()">Comenzar</button>
        <div id="mensaje-error" class="error"></div>
    </div>

    <div id="pantalla-cuestionario" class="contenedor oculto">
        <h1 id="saludo-usuario">Hola</h1>
        <p>Por favor responde con honestidad.</p>
        
        <form id="formulario-respuestas">
            <div id="lista-preguntas"></div>
            <button type="button" onclick="alert('¬°En la pr√≥xima fase guardaremos esto!')">Enviar Evaluaci√≥n</button>
        </form>
    </div>

    <script>
        // ----------------------------------------------------
        // üëá PEGA TU URL AQU√ç üëá
        const URL_SCRIPT = "https://script.google.com/macros/s/AKfycbxCSvVVoN4VQT-qWTDH3SFhF9Ng0dqs0PjLMAq1ui4auYGHVdbpwkytrMtL0MF3Cwk6/exec";
        // ----------------------------------------------------

        function iniciarSesion() {
            var id = document.getElementById("idEmpleado").value;
            var btn = document.getElementById("btnEntrar");
            var error = document.getElementById("mensaje-error");

            if (!id) return;

            btn.innerText = "Cargando...";
            btn.disabled = true;
            error.innerText = "";

            fetch(URL_SCRIPT + "?id=" + id)
            .then(r => r.json())
            .then(datos => {
                if (datos.estado === "ENCONTRADO") {
                    mostrarCuestionario(datos);
                } else {
                    error.innerText = "‚ùå ID no encontrado";
                    btn.innerText = "Comenzar";
                    btn.disabled = false;
                }
            })
            .catch(e => {
                error.innerText = "Error de conexi√≥n";
                btn.innerText = "Comenzar";
                btn.disabled = false;
            });
        }

        function mostrarCuestionario(datos) {
            // 1. Ocultar Login y Mostrar Cuestionario
            document.getElementById("pantalla-login").classList.add("oculto");
            document.getElementById("pantalla-cuestionario").classList.remove("oculto");

            // 2. Personalizar saludo
            document.getElementById("saludo-usuario").innerText = "Hola, " + datos.datosUsuario.nombre;

            // 3. Generar las preguntas din√°micamente
            var contenedorPreguntas = document.getElementById("lista-preguntas");
            contenedorPreguntas.innerHTML = ""; // Limpiar por si acaso

            // Por cada pregunta que lleg√≥ desde Google Sheets...
            datos.cuestionario.forEach((pregunta, indice) => {
                var htmlPregunta = `
                    <div class="bloque-pregunta">
                        <label class="texto-pregunta">${indice + 1}. ${pregunta}</label>
                        <textarea placeholder="Escribe tu respuesta aqu√≠..."></textarea>
                    </div>
                `;
                contenedorPreguntas.innerHTML += htmlPregunta;
            });
        }
    </script>

</body>
</html>